knitr::opts_chunk$set(echo = TRUE)
# Load Pacakges
library(tidyverse)
# Load Pacakges
library(tidyverse)
#getwd()
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>% select(-1)
features <- colnames(df)[1:17]
# subset the cards
cards <- df %>%
select(-features)
cards <- t(cards)
head(rownames(cards))
# PCA
card_PCA <- prcomp(cards, center = T, scale. = T)
View(df)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
```{r}
# Load Pacakges
library(tidyverse)
#getwd()
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
reg1 <- lm(win_rate_RE~., data = df)
summary(reg1)
knitr::opts_chunk$set(echo = TRUE)
# Load Pacakges
library(tidyverse)
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
hist(df$win_rate_RE/100, freq = F)
View(df)
df <- df %>% select(-X1, -Deck_URL, -Deck_ID)
View(df)
df <- df %>% select(-X1, -Deck_URL, -Deck_ID, -Deck_Name)
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>% select(-X1, -Deck_URL, -Deck_ID, -Deck_Name)
hist(df$win_rate_RE/100, freq = F)
colnames(df)[1:9]
colnames(df)[2:13]
colnames(df)[2:14]
colnames(df)[2:15]
colnames(df)[2:14]
reg1 <- lm(win_rate_RE~colnames(df)[2:14], data = df)
paste0(colnames(df)[2:14], "+")
paste0("+",colnames(df)[2:14])
paste0(colnames(df)[2:14])
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+Rogue+Priest+Paladin+Mage+Hunter+Druid+Demon Hunter, data = df)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+Rogue+Priest+Paladin+Mage+Hunter+Druid, data = df)
summary(reg1)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid+Demon\Hunter, data = df)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid+Demon/Hunter, data = df)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid+Demon\ Hunter, data = df)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid+Demon\/Hunter, data = df)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid+`Demon Hunter`, data = df)
summary(reg1)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid+`"Demon Hunter"`, data = df)
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name) %>%
select(Demon_Hunter = Demon Hunter)
View(df)
df <- df %>%
select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name)
View(df)
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>%
select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name)
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>%
#select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name)
View(df)
#df <-
df %>% select(Demon_Hunter = 14) %>% View
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>%
#select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name) %>%
rename(Demon_Hunter = Demon Hunter)
View(df)
View(df)
View(df)
df <- df %>%
#select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name) %>%
rename(Demon_Hunter = `Demon Hunter`)
View(df)
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>%
#select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name) %>%
rename(Demon_Hunter = `Demon Hunter`)
hist(df$win_rate_RE/100, freq = F)
paste0(colnames(df)[2:14])
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid+Demon_Hunter, data = df)
summary(reg1)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid, data = df)
summary(reg1)
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid, data = df)
summary(reg1)
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>%
#select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name, -`Demon Hunter`) %>%
#rename(Demon_Hunter = `Demon Hunter`)
View(df)
df <- df %>%
#select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name, -`Demon Hunter`)
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
# Load Data
df <- read_csv("/Users/Andy 1/Google 雲端硬碟 (r08323004@g.ntu.edu.tw)/0 Semesters/109-1/四 ccClub進階班/Final Projects/HS_Decks/2_tidy_data/data/df_Decks_tidy.csv")
df <- df %>%
#select(Demon_Hunter = 15) %>%
select(-X1, -Deck_URL, -Deck_ID, -Deck_Name, -`Demon Hunter`)
View(df)
hist(df$win_rate_RE/100, freq = F)
colnames(df)[2:14]
reg1 <- lm(win_rate_RE~time_duration_RE+game_count_RE+dust_cost+
Warrior+Warlock+Shaman+
Rogue+Priest+Paladin+
Mage+Hunter+Druid, data = df)
summary(reg1)
reg2 <- lm(win_rate_RE~., data = df)
summary(reg2)
library(glmnet) #Lasso
train_rows = sample(1:length(df), 0.66*length(df))
train_rows
X.train = df[train_rows,]
X.test = df[-train_rows,]
X <- df %>% select(-win_rate_RE)
View(X)
Y <- df %>% select(win_rate_RE)
View(Y)
X.train = X[train_rows,]
X.test = X[-train_rows,]
Y.train = Y[train_rows,]
Y.test = Y[-train_rows,]
#Obtain the optimal lambda through cross validation
alpha1.fit = cv.glmnet(X.train, Y.train, type.measure = "mse", alpha = 1, family = "gaussian")
X.train = as.matrix(X[train_rows,])
X.test = as.matrix(X[-train_rows,])
#Obtain the optimal lambda through cross validation
alpha1.fit = cv.glmnet(X.train, Y.train, type.measure = "mse", alpha = 1, family = "gaussian")
train_rows = sample(1:length(df), 0.66*length(df))
X <- df %>% select(-win_rate_RE)
Y <- df %>% select(win_rate_RE)
X.train = as.matrix(X[train_rows,])
X.test = as.matrix(X[-train_rows,])
Y.train = as.matrix(Y[train_rows,])
Y.test = as.matrix(Y[-train_rows,])
#Obtain the optimal lambda through cross validation
alpha1.fit = cv.glmnet(X.train, Y.train, type.measure = "mse", alpha = 1, family = "gaussian")
alpha1.predict = predict(alpha1.fit, s = alpha1.fit$lambda.1se, newx = X.test)
mean((Y.test - alpha1.predict)^2)
alpha1.fit$lambda.1se
################################################
#看看得到的weight
lasso.coef = predict(lasso.mod, type = 'coefficients', s = alpha1.fit$lambda.1se)
#Trying different tuning parameter: lambda
grid = 10^seq(2, -2, length = 1000)
lasso.mod = glmnet(X, Y, alpha = 1, lambda = grid, intercept = F)
X <- df %>% select(-win_rate_RE) %>% as.matrix
Y <- df %>% select(win_rate_RE) %>% as.matrix
#Trying different tuning parameter: lambda
grid = 10^seq(2, -2, length = 1000)
lasso.mod = glmnet(X, Y, alpha = 1, lambda = grid, intercept = F)
plot(lasso.mod, xvar = 'lambda')
plot(lasso.mod)
X.train = as.matrix(X[train_rows,])
X.test = as.matrix(X[-train_rows,])
Y.train = as.matrix(Y[train_rows,])
Y.test = as.matrix(Y[-train_rows,])
#Obtain the optimal lambda through cross validation
alpha1.fit = cv.glmnet(X.train, Y.train, type.measure = "mse", alpha = 1, family = "gaussian")
alpha1.predict = predict(alpha1.fit, s = alpha1.fit$lambda.1se, newx = X.test)
mean((Y.test - alpha1.predict)^2)
alpha1.fit$lambda.1se
################################################
#看看得到的weight
lasso.coef = predict(lasso.mod, type = 'coefficients', s = alpha1.fit$lambda.1se)
lasso.coef #估出的係數(投資某檔股票的權重)
lasso.coef #估出的係數(投資某檔股票的權重)
lasso.coef[lasso.coef>0 | lasso.coef<0] #只看那些不為零的
sum(lasso.coef) #權重之和大於一表示有槓桿
lasso.coef[lasso.coef>0 | lasso.coef<0] #只看那些不為零的
lasso.coef #估出的係數(投資某檔股票的權重)
lasso.coef[lasso.coef>0 | lasso.coef<0] #只看那些不為零的
lasso.coef[lasso.coef>0 | lasso.coef<0];names(lasso.coef[lasso.coef>0 | lasso.coef<0]) #只看那些不為零的
lasso.coef[lasso.coef>0 | lasso.coef<0] #只看那些不為零的
names(lasso.coef)
name(lasso.coef)
lasso.coef #估出的係數(投資某檔股票的權重)
class(lasso.coef)
View(lasso.coef)
lasso.coef@x
paste(lasso.coef@i, lasso.coef@x)
paste(lasso.coef@Dimnames[[lasso.coef@i]], lasso.coef@x)
paste(lasso.coef@i, lasso.coef@x)
paste(colnames(df)[lasso.coef@i], lasso.coef@x)
paste(colnames(df)[lasso.coef@i], "\t",lasso.coef@x)
paste(colnames(df)[lasso.coef@i], "\\t",lasso.coef@x)
paste(colnames(df)[lasso.coef@i], "    ",lasso.coef@x)
colnames(df)[lasso.coef@i];lasso.coef@x)
colnames(df)[lasso.coef@i];lasso.coef@x
colnames(df)[lasso.coef@i]
colnames(df)[lasso.coef@i]
lasso.coef@Dimnames[[1]]
colnames(df)[lasso.coef@i]
colnames(df)[lasso.coef@i][1]
for(j in 1:15){
colnames(df)[lasso.coef@i][j]
lasso.coef@x[j]
}
print(lasso.coef@x[j])
for(j in 1:15){
print(colnames(df)[lasso.coef@i][j])
print(lasso.coef@x[j])
}
for(j in 1:15){
paste(colnames(df)[lasso.coef@i][j], lasso.coef@x[j])
}
for(j in 1:15){
paste(colnames(df)[lasso.coef@i][j], lasso.coef@x[j])
}
paste(colnames(df)[lasso.coef@i], "    ",lasso.coef@x)
paste(colnames(df)[lasso.coef@i], "      ",lasso.coef@x)
paste(colnames(df)[lasso.coef@i], "      ",lasso.coef@x)
colnames(df)[lasso.coef@i]
paste(colnames(df)[lasso.coef@i], "      ",lasso.coef@x)
LASSO_cards <- c("安全檢查員","盤牙督軍","維克圖斯","魔杖師","模範生史黛琳娜","愛玩筆的學生","討人厭的教師","導覽員","火爆的赤紅龍人","閃避飛龍","盜匪傘兵","托爾托朝聖者","虛無行者")
LASSO_cards
qnorm(0.99, lower.tail = F)
qnorm(0.995, lower.tail = F)
qnorm(0.995, lower.tail = T)
qnorm(0.01, lower.tail = F)
qnorm(0.01/2, lower.tail = F)
qnorm(0.05/2, lower.tail = F)
qnorm(0.05, lower.tail = F)
pnorm(-1/3, lower.tail = F)
pnorm(0, lower.tail = F)
-1/3
pnorm(-1/3, lower.tail = F)
pnorm(-1/3, lower.tail = T)
pnorm(2.04124, lower.tail = F)
pnorm(6.736, lower.tail = T)
pnorm(6.736, lower.tail = F)
